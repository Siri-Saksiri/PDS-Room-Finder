<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PDS Room Finder | Find Your Room</title>

  <!-- favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

  <style>
    :root{
      --bg:#0F1B2D; --header:#1C4966; --accent:#3E7CB1; --muted:#b0c7e1;
      --table-row:#2c5a84;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background:var(--bg); color:#fff; min-height:100vh;
    }

    header{
      background:var(--header); width:100%;
      padding:10px 24px;
      display:flex; align-items:center; gap:12px;
      position:fixed; top:0; left:0;
      box-shadow:0 2px 8px rgba(0,0,0,0.3);
    }
    .logo-section{display:flex;align-items:center;gap:10px}
    .logo-section img{height:45px;width:auto}
    .logo-section h1{margin:0;font-size:1.25rem}

    main{padding:120px 16px 40px; display:flex;flex-direction:column;align-items:center}

    h2{font-size:2rem;margin:0 0 6px}
    p{color:var(--muted); margin:0 0 18px; font-size:1.05rem}

    /* table */
    .table-wrap{width:100%;max-width:900px}
    table{
      border-collapse:collapse; width:100%;
      background:var(--header); color:#fff; border-radius:10px; overflow:hidden;
      box-shadow:0 6px 18px rgba(0,0,0,0.25);
    }
    thead th{
      background:var(--accent); padding:12px 14px; text-align:left; font-weight:600;
      font-size:0.98rem;
    }
    tbody tr{background:transparent; transition:background .18s}
    tbody tr:hover{background:var(--table-row)}
    td{padding:12px 14px; border-bottom:1px solid rgba(255,255,255,0.06); font-size:0.98rem}
    .muted{color:var(--muted)}

    /* empty-state */
    .empty{color:var(--muted); padding:20px 10px; text-align:center}

    /* small footer action */
    .small-actions{margin-top:18px; display:flex;gap:10px; align-items:center}
    .btn{
      background:var(--accent); color:#fff; padding:8px 12px; border-radius:8px;
      text-decoration:none; display:inline-block; font-weight:600; transition:opacity .12s;
    }
    .btn:hover{opacity:.9}

    /* responsive */
    @media (max-width:520px){
      h2{font-size:1.5rem}
      .logo-section h1{font-size:1rem}
      thead th, td{padding:10px}
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-section">
      <img src="/PDS room finder.png" alt="PDS Logo">
      <h1>PDS Room Finder</h1>
    </div>
  </header>

  <main>
    <h2>Find The Teacher's Room</h2>
    <p>หาห้องพักของอาจารย์ด้วยความง่ายดาย</p>

    <div class="table-wrap">
      <table id="teacher-table" aria-describedby="table-desc">
        <thead>
          <tr>
            <th>Name</th>
            <th>Room</th>
          </tr>
        </thead>
        <tbody id="table-body">
          <!-- rows inserted by JS -->
        </tbody>
      </table>
      <div id="empty" class="empty" style="display:none">No teacher data found. Use the secret admin page to add entries.</div>
    </div>

    <div class="small-actions">
      <a class="btn" href="/">← Back to First Page</a>
      <span class="muted" style="font-size:0.95rem">Secret admin page: manually visit <code>/crazy-train</code></span>
    </div>
  </main>

  <script>
    // key used in localStorage
    const STORAGE_KEY = 'pds_teachers';

    // default sample data (used only if localStorage has no data)
    const DEFAULT_DATA = [
      {name: "Mr. Somchai Wattanapan", room: "Room 201"},
      {name: "Ms. Siriporn Thanawan", room: "Room 305"},
      {name: "Mr. Adisak Rattana", room: "Room 108"},
      {name: "Mrs. Kanokwan Chaisiri", room: "Room 402"},
      {name: "Mr. Preecha Sutthipong", room: "Room 214"}
    ];

    function getData(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return DEFAULT_DATA.slice();
        const parsed = JSON.parse(raw);
        if(!Array.isArray(parsed)) return DEFAULT_DATA.slice();
        return parsed;
      }catch(e){
        console.error('Error parsing teacher data', e);
        return DEFAULT_DATA.slice();
      }
    }

    function renderTable(){
      const data = getData();
      const tbody = document.getElementById('table-body');
      const emptyEl = document.getElementById('empty');
      tbody.innerHTML = '';
      if(!data || data.length===0){
        emptyEl.style.display = 'block';
        document.getElementById('teacher-table').style.display = 'none';
        return;
      }else{
        emptyEl.style.display = 'none';
        document.getElementById('teacher-table').style.display = 'table';
      }

      data.forEach(row => {
        const tr = document.createElement('tr');

        const tdName = document.createElement('td');
        tdName.textContent = row.name || '';
        tr.appendChild(tdName);

        const tdRoom = document.createElement('td');
        tdRoom.textContent = row.room || '';
        tr.appendChild(tdRoom);

        tbody.appendChild(tr);
      });
    }

    // initial render
    renderTable();

    // listen to storage events from other tabs/windows and re-render
    window.addEventListener('storage', (e)=>{
      if(e.key === STORAGE_KEY) renderTable();
    });
  </script>
</body>
</html>
